const assert = require('assert');
const enrichToken = require('../../lib/handlers/enrich-token');
const utils = require('../../lib/commons/utils');
const log = require('../../lib/commons/log');
const path = require('path');

describe('main', function () {
  it('Encrypt flights', function () {
    const sample = utils.readJSONFile(path.resolve(__dirname, '../sample-response-flights.json'));
    enrichToken.encryptFlights(sample.flights);
    for (var f = 0; f < sample.flights.length; f++) {
      var flight = sample.flights[f];
      for (var s = 0; s < flight.segments.length; s++) {
        var segments = flight.segments[s];
        assert.ok(segments.rateToken.length > 0, "RateToken null");
      }
    }
  });
});